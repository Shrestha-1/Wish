<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Happy Birthday ğŸ‰</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&family=Great+Vibes&display=swap" rel="stylesheet" />
 <link rel="stylesheet" href="birthday.css" />
 <link rel="shortcut icon" href="favicon.ico" type="image/Top.png">

</head>
<body>
  <div class="stars"></div>
  <div id="confetti"></div>

  <header>
    <div>
      <div class="title">Happy Birthday ğŸ‚</div>
      <div class="subtitle">Sending surprises across the miles âœ¨</div>
    </div>
  </header>

  <main class="card">
    <section class="panel">
      <div class="hero-emoji">ğŸ‰ ğŸ‚ âœ¨ ğŸ’– ğŸ ğŸŒ¸ ğŸŒŸ </div>
      <p class="dear" id="dear-text"></p>
      <p class="wish" id="wish-text"></p>
<div class="signature" id="signature-text"></div>

    </section>

    <section class="panel">
      <h2 id="countdown-title" style="margin: 0 0 10px 0; font-size: 22px; text-align: center;">
  Countdown to your birthday
</h2>
      <div class="countdown">
        <div class="timebox">
          <div class="num" id="days">--</div>
          <div class="lab">Days</div>
        </div>
        <div class="timebox">
          <div class="num" id="hours">--</div>
          <div class="lab">Hours</div>
        </div>
        <div class="timebox">
          <div class="num" id="mins">--</div>
          <div class="lab">Minutes</div>
        </div>
        <div class="timebox">
          <div class="num" id="secs">--</div>
          <div class="lab">Seconds</div>
        </div>
      </div>
      <div id="celebration" aria-live="polite" role="alert" aria-atomic="true" aria-relevant="additions">
        <span>ğŸ‚</span>
        <span>ğŸˆ</span>
        <span>ğŸ’–</span>
        <span>ğŸ‰</span>
        <span>ğŸ</span>
        <span>ğŸ¥³</span>
        <span>ğŸˆ</span>
        <span>ğŸ’–</span>
        <span>ğŸ‚</span>
      </div>
    </section>

    <section class="panel footer">
      <div>Made with love, emojis, and a little bit of stardust âœ¨</div>
    </section>
  </main>

  <script>
 // ===============================
// CELEBRATION EMOJI PREP
// ===============================
const celebrationSection = document.getElementById("celebration");
const celebrationSpans = celebrationSection.querySelectorAll("span");

function prepareCelebrationEmojis() {
  celebrationSpans.forEach(span => {
    const sway = Math.random() * 30 - 15;
    const delay = Math.random() * 5;
    span.style.setProperty("--sway", sway + "px");
    span.style.animationDelay = delay + "s";
  });
}
prepareCelebrationEmojis();

// ===============================
// CONFETTI LOGIC
// ===============================
const confettiContainer = document.getElementById("confetti");
let backgroundConfettiPieces = [];

function createConfettiPiece({ left, duration, delay, size, rotate, infinite }) {
  const span = document.createElement("span");
  span.className = "confetti-piece";
  span.style.left = left + "vw";
  span.style.width = size + "px";
  span.style.height = size * 1.8 + "px";
  span.style.backgroundColor = `hsl(${Math.random() * 360}, 90%, 70%)`;
  span.style.setProperty("--rot", rotate + "deg");
  span.style.animationDuration = duration + "s";
  span.style.animationDelay = delay + "s";
  span.style.animationIterationCount = infinite ? "infinite" : "1";
  confettiContainer.appendChild(span);

  if (!infinite) {
    span.addEventListener("animationend", () => span.remove());
  }

  return span;
}

function createInitialBurst() {
  for (let i = 0; i < 30; i++) {
    createConfettiPiece({
      left: Math.random() * 100,
      duration: 3 + Math.random() * 2,
      delay: Math.random() * 2,
      size: 8 + Math.random() * 6,
      rotate: Math.random() * 360,
      infinite: false
    });
  }
}

function createBackgroundConfetti() {
  backgroundConfettiPieces.forEach(p => p.remove());
  backgroundConfettiPieces = [];

  for (let i = 0; i < 10; i++) {
    backgroundConfettiPieces.push(
      createConfettiPiece({
        left: Math.random() * 100,
        duration: 15 + Math.random() * 15,
        delay: -Math.random() * 10,
        size: 6 + Math.random() * 5,
        rotate: Math.random() * 360,
        infinite: true
      })
    );
  }
}

function startConfettiFlow() {
  if (!localStorage.getItem("birthdayConfettiDone")) {
    createInitialBurst();
    setTimeout(() => {
      createBackgroundConfetti();
      localStorage.setItem("birthdayConfettiDone", "true");
    }, 10000);
  } else {
    createBackgroundConfetti();
  }
}

startConfettiFlow();

// ===============================
// LOAD BIRTHDAY DATA (without countdown)
// ===============================
async function loadBirthdayData() {
  const name = sessionStorage.getItem("birthdayName");

  if (!name) {
    document.body.innerHTML =
      '<div style="color:yellow;text-align:center;margin-top:50px;">Name not found.</div>';
    return;
  }

  try {
    const res = await fetch("birthdays.json");
    const data = await res.json();

    const person = data.find(
      p => p.name.toLowerCase() === name.toLowerCase()
    );

    if (!person) {
      document.body.innerHTML =
        `<div style="color:yellow;text-align:center;margin-top:50px;">${name} not found.</div>`;
      return;
    }

    document.querySelector(".title").textContent =
      `Happy Birthday ${person.name} ğŸ‚`;
    document.getElementById('dear-text').textContent = `Dear ${person.name},`;
    document.getElementById('wish-text').textContent = person.wish;
    document.getElementById("signature-text").textContent = person.signature;
    document.getElementById('countdown-title').textContent = person.countdownMessage || "Countdown to your birthday ğŸ’–";

    // NOTE: Countdown is now handled in separate JS
    if (window.loadCountdownFor) {
      window.loadCountdownFor(person.date); // call separate countdown.js
    }

  } catch (err) {
    console.error(err);
    document.body.innerHTML =
      '<div style="color:yellow;text-align:center;margin-top:50px;">Error loading data.</div>';
  }
}

loadBirthdayData();
// SECRET ADMIN TRIGGER ON "Minutes"
let clickCount = 0;
const requiredClicks = 10;
const triggerTime = 5000; // reset after 5 seconds of inactivity
let clickTimer = null;

// Find all elements with class "lab"
const labElements = document.querySelectorAll(".lab");

// Find the one that has the text "Minutes"
let minutesLabel = null;
labElements.forEach(el => {
  if (el.textContent.trim() === "Minutes") {
    minutesLabel = el;
  }
});

if (minutesLabel) {
  minutesLabel.addEventListener("click", () => {
    clickCount++;

    // Reset the counter after inactivity
    if (clickTimer) clearTimeout(clickTimer);
    clickTimer = setTimeout(() => clickCount = 0, triggerTime);

    // Trigger admin page
    if (clickCount >= requiredClicks) {
      window.location.href = "admin.html";
    }
  });
}

</script>
<script src="countdown.js"></script>
</body>
</html>
